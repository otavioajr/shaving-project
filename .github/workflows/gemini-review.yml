name: 'ðŸ”Ž Gemini Review'

on:
  pull_request:
    types: [opened, synchronize, reopened]

concurrency:
  group: '${{ github.workflow }}-${{ github.event.pull_request.number || github.ref }}'
  cancel-in-progress: true

jobs:
  review:
    runs-on: 'ubuntu-latest'
    timeout-minutes: 10
    permissions:
      contents: 'read'
      pull-requests: 'write'
      issues: 'write'

    steps:
      - name: 'Checkout repository'
        uses: 'actions/checkout@v4'

      - name: 'Run Gemini PR Review'
        uses: 'google-github-actions/run-gemini-cli@v0'
        id: 'gemini_pr_review'
        env:
          GITHUB_TOKEN: '${{ secrets.GITHUB_TOKEN }}'
        with:
          gemini_api_key: '${{ secrets.GEMINI_API_KEY }}'

          # ATUALIZADO: Usando o modelo mais recente disponÃ­vel
          gemini_model: 'gemini-2.0-flash' # VocÃª tambÃ©m pode usar 'gemini-2.0-pro' se tiver acesso

          command: 'review'

          settings: |-
            {
              "model": {
                "maxSessionTurns": 15
              },
              "mcpServers": {
                "github": {
                  "command": "npx",
                  "args": ["-y", "@modelcontextprotocol/server-github"],
                  "env": {
                    "GITHUB_PERSONAL_ACCESS_TOKEN": "${GITHUB_TOKEN}"
                  }
                }
              }
            }
